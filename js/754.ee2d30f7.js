"use strict";(self["webpackChunkfullstack_ecommerce_pojui"]=self["webpackChunkfullstack_ecommerce_pojui"]||[]).push([[754],{8965:function(t,e,a){a.d(e,{PW:function(){return d},db:function(){return n},j2:function(){return r}});var s=a(223),i=a(1601),l=a(1884);const c={apiKey:"AIzaSyA9DPx8_HE6nrr3Ur84EcVp1UvIM7Tmsyg",authDomain:"ecommerce-user-e27fa.firebaseapp.com",projectId:"ecommerce-user-e27fa",storageBucket:"ecommerce-user-e27fa.appspot.com",messagingSenderId:"963949372026",appId:"1:963949372026:web:8c37ee1e37682669b091c3",measurementId:"G-XC0ZSW2MQP"},o=(0,s.Wp)(c),r=(0,i.xI)(o),n=(0,l.aU)(o),d=new i.HF;new i.sk},9754:function(t,e,a){a.r(e),a.d(e,{default:function(){return pt}});var s=a(641),i=a(2644),l=a(9322);const c=(0,s.Lk)("i",{class:"loading-box"},null,-1),o=(0,s.Lk)("div",{class:"cart-banner"},[(0,s.Lk)("h2",{class:"text-center"},"購物車")],-1),r={class:"container my-5 m-cart-box"},n={class:"row align-items-center"},d={key:0},u={class:"mt-3"},p=(0,s.Lk)("thead",{class:"font-weight-bold"},[(0,s.Lk)("tr",null,[(0,s.Lk)("th"),(0,s.Lk)("th",{class:"text-left"},"商品"),(0,s.Lk)("th",{class:"text-center"},"數量"),(0,s.Lk)("th",null,"單位"),(0,s.Lk)("th",{class:"text-right"},"單價")])],-1),m={class:"border-y"},h=["onClick"],f=(0,s.Lk)("i",{class:"far fa-trash-alt"},null,-1),k=[f],b={class:"produce-num-td"},g={class:"produce-num-group d-flex"},v={class:"num-btnbox"},L=["onClick"],y=(0,s.Lk)("i",{class:"fas fa-minus"},null,-1),x=[y],C=["value","onKeyup"],w={class:"num-btnbox"},I=["onClick"],T=(0,s.Lk)("i",{class:"fas fa-plus"},null,-1),_=[T],A=(0,s.Lk)("span",null,"/",-1),j={class:"text-right"},$={colspan:"4"},D=(0,s.Lk)("i",{class:"far fa-trash-alt"},null,-1),E=(0,s.Lk)("span",{class:"pl-2"},"刪除所有商品",-1),X=[D,E],q={key:1,class:"mb-3 no-shop-box"},H=(0,s.Lk)("p",{class:"py-5 mt-3"},"哎呀！您的購物車是空的，趕快去挑選美品吧！",-1),M=(0,s.Lk)("i",{class:"fas fa-reply mr-2"},null,-1),W={class:"card-body"},U=(0,s.Lk)("h3",null,"訂單價格",-1),B={class:"px-4 mt-3"},G={class:"d-flex justify-content-between"},F=(0,s.Lk)("span",null,"小計：",-1),S={key:0,class:"d-flex fare justify-content-between"},V=(0,s.Lk)("span",null,"運費：",-1),z={key:0},K={key:1},Q=(0,s.Lk)("hr",{class:"m-0 my-2"},null,-1),N={key:1,class:"text-right promotion"},P={key:2,class:"text-right free"},Y={class:"d-flex justify-content-between"},Z=(0,s.Lk)("span",null,"總計：",-1),J=(0,s.Lk)("hr",{class:"hr-opa"},null,-1),R={class:"mt-3 mb-2 check-box"},O=(0,s.Lk)("i",{class:"fas fa-reply mr-2"},null,-1),tt={class:"float-right"},et={key:0,class:"bg-cart-footer"},at=(0,s.Fv)('<div class="container pt-4"><h4 class="font-weight-bold text-center h4">香氛蠟燭冷知識</h4><div class="row mt-4 m-footer-cart"><div class="col-lg-4 col-md-6 mb-4" data-aos="zoom-in"><div class="knowledge-img position-relative" style="background-image:url(https://images.unsplash.com/photo-1489176876421-3b720db0fb3d?q=80&amp;w=2070&amp;auto=format&amp;fit=crop&amp;ixlib=rb-4.0.3&amp;ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D);"><div class="knowledge-box"><h5 class="font-weight-bolder pt-3 pb-2 pl-4">燃燒溫度</h5><p class="px-4 my-3"> 香氛蠟燭的火焰溫度約為1000°C，因此要小心放置，避免接觸易燃物。 </p></div></div></div><div class="col-lg-4 col-md-6 mb-4" data-aos="zoom-in"><div class="knowledge-img position-relative" style="background-image:url(https://images.unsplash.com/photo-1602523961358-f9f03dd557db?q=80&amp;w=2070&amp;auto=format&amp;fit=crop&amp;ixlib=rb-4.0.3&amp;ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D);"><div class="knowledge-box"><h5 class="font-weight-bolder pt-3 pb-2 pl-4">熔點差異</h5><p class="px-4 my-3"> 蜂蠟的熔點約為62-64°C，石蠟蠟燭的熔點約為46-68°C，大豆蠟的熔點約為49-55°C。 </p></div></div></div><div class="col-lg-4 col-md-6 mb-4" data-aos="zoom-in"><div class="knowledge-img position-relative" style="background-image:url(https://images.unsplash.com/photo-1495640452828-3df6795cf69b?q=80&amp;w=1887&amp;auto=format&amp;fit=crop&amp;ixlib=rb-4.0.3&amp;ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D);"><div class="knowledge-box"><h5 class="font-weight-bolder pt-3 pb-2 pl-4">歷史用途</h5><p class="px-4 my-3"> 香氛蠟燭在歷史上常被用於宗教儀式、醫療用途和貴族宴會，以掩蓋不良氣味或創造特定氛圍。 </p></div></div></div></div></div>',1),st=[at];function it(t,e,a,f,y,T){const D=(0,s.g2)("loading"),E=(0,s.g2)("router-link");return(0,s.uX)(),(0,s.CE)("div",null,[(0,s.bF)(D,{active:y.isLoading},{default:(0,s.k6)((()=>[c])),_:1},8,["active"]),o,(0,s.Lk)("div",r,[(0,s.Lk)("div",n,[(0,s.Lk)("div",{class:(0,i.C4)(["col-lg-8 commodity-box",{"col-lg-12":y.fareTotal<=0,"none-commodity":y.fareTotal<=0}])},[y.carts.length>0?((0,s.uX)(),(0,s.CE)("div",d,[(0,s.Lk)("table",u,[p,(0,s.Lk)("tbody",m,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(y.carts,(e=>((0,s.uX)(),(0,s.CE)("tr",{key:e.product_id+1},[(0,s.Lk)("td",null,[(0,s.Lk)("button",{type:"button",class:"btn btn-outline-danger-trash btn-sm",onClick:t=>T.removeCartItem(e.product_id)},k,8,h)]),(0,s.Lk)("td",null,(0,i.v_)(e.product.title),1),(0,s.Lk)("td",b,[(0,s.Lk)("div",g,[(0,s.Lk)("div",v,[(0,s.Lk)("button",{class:"btn",onClick:t=>T.quantityUpdata(e.product_id,e.qty-1)},x,8,L)]),(0,s.Lk)("input",{type:"number",class:"form-control text-center numbox",value:e.qty,onKeyup:(0,l.jR)((t=>T.quantityUpdata(e.product_id,t.target.value)),["enter"])},null,40,C),(0,s.Lk)("div",w,[(0,s.Lk)("button",{class:"btn",onClick:t=>T.quantityUpdata(e.product_id,e.qty+1)},_,8,I)])])]),(0,s.Lk)("td",null,[A,(0,s.eW)(" "+(0,i.v_)(e.product.unit),1)]),(0,s.Lk)("td",j,(0,i.v_)(t.$filters.currency(e.product.price)),1)])))),128))]),(0,s.Lk)("tfoot",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("td",$,[(0,s.Lk)("button",{type:"button",class:"btn btn-del-all sideline btn-sm float-left my-3",onClick:e[0]||(e[0]=t=>T.removeAllCartItem())},X)])])])])])):((0,s.uX)(),(0,s.CE)("div",q,[H,(0,s.bF)(E,{to:"/products",class:"text-dark"},{default:(0,s.k6)((()=>[M,(0,s.eW)(" 繼續購買 ")])),_:1})]))],2),(0,s.Lk)("div",{class:(0,i.C4)(["col-lg-4 my-3 card order-price",{"d-none":y.fareTotal<=0}])},[(0,s.Lk)("div",W,[U,(0,s.Lk)("div",B,[(0,s.Lk)("p",G,[F,(0,s.Lk)("span",null,(0,i.v_)(t.$filters.currency(y.cartTotal)),1)]),0!==y.cartTotal?((0,s.uX)(),(0,s.CE)("p",S,[V,y.cartTotal>599?((0,s.uX)(),(0,s.CE)("span",z," NT 0")):((0,s.uX)(),(0,s.CE)("span",K," NT 60"))])):(0,s.Q3)("",!0),Q,y.cartTotal<599||0===y.cartTotal?((0,s.uX)(),(0,s.CE)("p",N," 優惠促銷：滿 599 免運 ")):((0,s.uX)(),(0,s.CE)("p",P,"已達免運優惠")),(0,s.Lk)("p",Y,[Z,(0,s.Lk)("span",null,(0,i.v_)(t.$filters.currency(y.fareTotal)),1)]),J,(0,s.Lk)("div",R,[(0,s.Lk)("div",null,[y.carts.length>0?((0,s.uX)(),(0,s.Wv)(E,{key:0,to:"/products",class:"continue-buy"},{default:(0,s.k6)((()=>[O,(0,s.eW)(" 繼續購買 ")])),_:1})):(0,s.Q3)("",!0)]),(0,s.Lk)("div",tt,[(0,s.bF)(E,{to:"/order",class:(0,i.C4)(["btn btn-shopping checkout",{disabled:y.fareTotal<=0}])},{default:(0,s.k6)((()=>[(0,s.eW)(" 結帳 ")])),_:1},8,["class"])])])])])],2)])]),y.isLoading?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("section",et,st))])}var lt=a(2541),ct=a(8965),ot=a(1601),rt=a(1884),nt={data(){return{carts:{},cartTotal:0,fareTotal:0,isLoading:!1,products:{},coupon_code:"",userCartItems:[],uid:null}},created(){this.getAuthState()},watch:{uid(t,e){t||this.$router.replace("/userlogin")}},methods:{getAuthState(){(0,ot.hg)(ct.j2,(t=>{t?t.emailVerified?(this.uid=t.uid,this.getCart(t.uid)):this.uid=null:(this.uid=null,lt.A.fire({icon:"warning",title:"請先登入會員"}),this.$router.replace("/userlogin"))}))},async updateUserCartItem(t){const e=(0,rt.rJ)(ct.db,"userInfo"),a=(0,rt.H9)(e,this.uid),s=await(0,rt.x7)(a);s.exists()?(this.userCartItems=s.data().cartItem,void 0!==t&&(this.userCartItems=t,await(0,rt.mZ)(a,{cartItem:this.userCartItems}))):console.log("No such document!")},getCart(t){const e=`https://fullstack-ecommerce-pojui-backend-vercel.vercel.app/cart/${t}`;this.isLoading=!0,setTimeout((()=>{this.$http.get(e).then((t=>{this.carts=t.data.data.carts,null!==this.uid&&this.updateUserCartItem(this.carts),this.updateTotal(),this.isLoading=!1})).catch((()=>{lt.A.fire({title:"資料讀取失敗，請稍後再試",icon:"error"}),this.isLoading=!1}))}),1e3)},updateTotal(){let t=0;this.carts.forEach((e=>{t+=e.product.price*e.qty})),this.cartTotal=t,this.fareTotal=t>=599||0===t?t:t+60},quantityUpdata(t,e){this.isLoading=!0,e=parseInt(e),setTimeout((()=>{if(e>=1){const a=`https://fullstack-ecommerce-pojui-backend-vercel.vercel.app/cart/${this.uid}`,s={product_id:t,qty:e};this.$http.put(a,{data:s}).then((t=>{this.getCart(this.uid),this.isLoading=!1}))}else lt.A.fire({title:"數量不得小於1",icon:"error"}),this.isLoading=!1}),1e3)},removeCartItem(t){this.isLoading=!0;const e=`https://fullstack-ecommerce-pojui-backend-vercel.vercel.app/cart/${this.uid}/${t}`;this.$http.delete(e).then((t=>{this.$emitter.emit("update-total",this.uid),this.getCart(this.uid),this.isLoading=!1,lt.A.fire({title:"商品已刪除",icon:"success"})})).catch((()=>{this.isLoading=!1,lt.A.fire({title:"商品刪除失敗",icon:"error"})}))},removeAllCartItem(){this.isLoading=!0;const t=`https://fullstack-ecommerce-pojui-backend-vercel.vercel.app/cart/${this.uid}`;this.$http.delete(t).then((()=>{this.$emitter.emit("update-total",this.uid),this.getCart(this.uid),this.cartTotal=0,this.isLoading=!1,lt.A.fire({title:"商品已全部刪除",icon:"success"})})).catch((()=>{this.isLoading=!1,lt.A.fire({title:"商品刪除失敗",icon:"error"})}))}}},dt=a(6262);const ut=(0,dt.A)(nt,[["render",it]]);var pt=ut}}]);
//# sourceMappingURL=754.ee2d30f7.js.map