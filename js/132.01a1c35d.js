"use strict";(self["webpackChunkfullstack_ecommerce_pojui"]=self["webpackChunkfullstack_ecommerce_pojui"]||[]).push([[132],{8965:function(t,a,e){e.d(a,{PW:function(){return d},db:function(){return r},j2:function(){return n}});var s=e(223),i=e(1601),o=e(1884);const l={apiKey:"AIzaSyA9DPx8_HE6nrr3Ur84EcVp1UvIM7Tmsyg",authDomain:"ecommerce-user-e27fa.firebaseapp.com",projectId:"ecommerce-user-e27fa",storageBucket:"ecommerce-user-e27fa.appspot.com",messagingSenderId:"963949372026",appId:"1:963949372026:web:8c37ee1e37682669b091c3",measurementId:"G-XC0ZSW2MQP"},c=(0,s.Wp)(l),n=(0,i.xI)(c),r=(0,o.aU)(c),d=new i.HF;new i.sk},8285:function(t,a,e){e.d(a,{A:function(){return k}});var s=e(641),i=e(9322),o=e(2644);const l={"aria-label":"Page navigation example"},c={class:"pagination justify-content-center"},n={class:"page-item"},r=(0,s.Lk)("span",{"aria-hidden":"true"},"«",-1),d=[r],u=["onClick"],p={class:"page-item"},m=(0,s.Lk)("span",{"aria-hidden":"true"},"»",-1),f=[m];function b(t,a,e,r,m,b){return(0,s.uX)(),(0,s.CE)("nav",l,[(0,s.Lk)("ul",c,[(0,s.Lk)("li",n,[(0,s.Lk)("a",{class:"page-link",href:"#",onClick:a[0]||(a[0]=(0,i.D$)((t=>b.updatePage(e.pages.current_page-1)),["prevent"])),"aria-label":"Previous"},d)]),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.pages.total_pages,(t=>((0,s.uX)(),(0,s.CE)("li",{class:(0,o.C4)(["page-item",{active:t===e.pages.current_page}]),key:t},[(0,s.Lk)("a",{class:"page-link",href:"#",onClick:(0,i.D$)((a=>b.updatePage(t)),["prevent"])},(0,o.v_)(t),9,u)],2)))),128)),(0,s.Lk)("li",p,[(0,s.Lk)("a",{class:"page-link",href:"#",onClick:a[1]||(a[1]=(0,i.D$)((t=>b.updatePage(e.pages.current_page+1)),["prevent"])),"aria-label":"Next"},f)])])])}var g={props:["pages"],methods:{updatePage(t){this.$emit("emit-pages",t)}}},h=e(6262);const v=(0,h.A)(g,[["render",b]]);var k=v},6132:function(t,a,e){e.r(a),e.d(a,{default:function(){return st}});var s=e(641),i=e(2644),o=e(9322);const l=t=>((0,s.Qi)("data-v-5b6c9ba4"),t=t(),(0,s.jt)(),t),c=l((()=>(0,s.Lk)("div",{class:"follow-banner"},[(0,s.Lk)("h2",{class:"text-center"},"追蹤商品")],-1))),n={class:"container follow-box"},r={class:"row"},d={class:"col-lg-8 col-md-12 mx-auto"},u=l((()=>(0,s.Lk)("i",{class:"loading-box"},null,-1))),p={class:"follow-title"},m={key:0},f={key:1},b=l((()=>(0,s.Lk)("option",{value:"",disabled:""},"商品排序",-1))),g=l((()=>(0,s.Lk)("option",{value:"highToLow"},"價格由高至低",-1))),h=l((()=>(0,s.Lk)("option",{value:"lowToHigh"},"價格由低至高",-1))),v=[b,g,h],k={key:0,class:"mb-5"},w={class:"followItem","data-aos":"fade-right"},C={class:"d-flex"},L=["src"],y={class:"followItem-content"},x={class:"followItem-category"},I={class:"followItem-cart"},D={key:0,class:"followItem-origin-price pl-3"},_=l((()=>(0,s.Lk)("br",null,null,-1))),P={class:"followItem-price pl-3"},E=["disabled","onClick"],A=l((()=>(0,s.Lk)("i",{class:"fas fa-spinner fa-spin"},null,-1))),X=["onClick"],$={class:"m-followItem-cart"},H={class:"m-fol-money"},j={key:0,class:"m-folItem-origin-price pr-2"},T={class:"pr-2 m-folItem-price"},F=["disabled","onClick"],M=l((()=>(0,s.Lk)("i",{class:"fas fa-spinner fa-spin"},null,-1))),W=["onClick"],U=["onClick"],B=l((()=>(0,s.Lk)("i",{class:"fas fa-times"},null,-1))),G=[B],Q={key:1,class:"my-5 no-follow"},V=l((()=>(0,s.Lk)("p",null,"目前沒有收藏任何商品唷！",-1))),S=l((()=>(0,s.Lk)("i",{class:"fas fa-reply mr-2"},null,-1))),q={key:0,class:"bg-follow-footer"},z=(0,s.Fv)('<div class="container pt-4" data-v-5b6c9ba4><h4 class="font-weight-bold text-center h4" data-v-5b6c9ba4>香氛蠟燭冷知識</h4><div class="row mt-4 m-footer-follow" data-v-5b6c9ba4><div class="col-lg-4 col-md-6 mb-4" data-aos="zoom-in" data-v-5b6c9ba4><div class="knowledge-img position-relative" style="background-image:url(https://images.unsplash.com/photo-1616968173950-4abf6a34c4b7?q=80&amp;w=1972&amp;auto=format&amp;fit=crop&amp;ixlib=rb-4.0.3&amp;ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D);" data-v-5b6c9ba4><div class="knowledge-box" data-v-5b6c9ba4><h5 class="font-weight-bolder pt-3 pb-2 pl-4" data-v-5b6c9ba4>顏色與香味</h5><p class="px-4 my-3" data-v-5b6c9ba4> 蠟燭的顏色和香味可以對情緒產生影響。例如，藍色蠟燭常被認為有助於放鬆，而柑橘類香味可以提神醒腦。 </p></div></div></div><div class="col-lg-4 col-md-6 mb-4" data-aos="zoom-in" data-v-5b6c9ba4><div class="knowledge-img position-relative" style="background-image:url(https://images.unsplash.com/photo-1597318109735-d3612887d1ad?q=80&amp;w=2071&amp;auto=format&amp;fit=crop&amp;ixlib=rb-4.0.3&amp;ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D);" data-v-5b6c9ba4><div class="knowledge-box" data-v-5b6c9ba4><h5 class="font-weight-bolder pt-3 pb-2 pl-4" data-v-5b6c9ba4>健康益處</h5><p class="px-4 my-3" data-v-5b6c9ba4> 一些香氛蠟燭含有精油，如薰衣草、迷迭香、桉樹等，這些精油有助於放鬆、減壓和改善睡眠品質。 </p></div></div></div><div class="col-lg-4 col-md-6 mb-4" data-aos="zoom-in" data-v-5b6c9ba4><div class="knowledge-img position-relative" style="background-image:url(https://images.unsplash.com/photo-1589536677029-c0aa1808fba6?q=80&amp;w=1780&amp;auto=format&amp;fit=crop&amp;ixlib=rb-4.0.3&amp;ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D);" data-v-5b6c9ba4><div class="knowledge-box" data-v-5b6c9ba4><h5 class="font-weight-bolder pt-3 pb-2 pl-4" data-v-5b6c9ba4>香味釋放</h5><p class="px-4 my-3" data-v-5b6c9ba4> 香氛蠟燭的香味釋放來自於蠟燭燃燒時加熱的香精油。這些油在高溫下揮發，釋放出香味。 </p></div></div></div></div></div>',1),J=[z];function K(t,a,e,l,b,g){const h=(0,s.g2)("loading"),B=(0,s.g2)("router-link");return(0,s.uX)(),(0,s.CE)("div",null,[c,(0,s.Lk)("div",n,[(0,s.Lk)("div",r,[(0,s.Lk)("div",d,[(0,s.bF)(h,{active:b.isLoading},{default:(0,s.k6)((()=>[u])),_:1},8,["active"]),(0,s.Lk)("div",p,[(0,s.Lk)("h3",null,[(0,s.eW)(" 我的收藏 "),b.followProduct.length>0?((0,s.uX)(),(0,s.CE)("span",m,"( "+(0,i.v_)(b.followProduct.length)+" )",1)):((0,s.uX)(),(0,s.CE)("span",f,"( 0 )"))]),b.followProduct.length>0?(0,s.bo)(((0,s.uX)(),(0,s.CE)("select",{key:0,name:"sortData",id:"sortData","onUpdate:modelValue":a[0]||(a[0]=t=>b.sortData=t),class:"form-control follow-sort mb-2",onChange:a[1]||(a[1]=t=>g.sortProduct())},v,544)),[[o.u1,b.sortData]]):(0,s.Q3)("",!0)]),b.followProduct.length>0?((0,s.uX)(),(0,s.CE)("div",k,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(b.followProduct,(a=>((0,s.uX)(),(0,s.CE)("div",{class:"mb-3",key:a.id},[(0,s.Lk)("div",w,[(0,s.Lk)("div",C,[(0,s.bF)(B,{to:`/product/${a.id}`},{default:(0,s.k6)((()=>[(0,s.Lk)("img",{class:"followItem-img",src:a.imageUrl,alt:""},null,8,L)])),_:2},1032,["to"]),(0,s.Lk)("div",y,[(0,s.Lk)("h5",null,(0,i.v_)(a.title),1),(0,s.Lk)("p",null,(0,i.v_)(a.content),1),(0,s.Lk)("p",x,(0,i.v_)(a.category),1)])]),(0,s.Lk)("div",I,[0!==a.origin_price?((0,s.uX)(),(0,s.CE)("span",D,(0,i.v_)(t.$filters.currency(a.origin_price)),1)):(0,s.Q3)("",!0),_,(0,s.Lk)("span",P,(0,i.v_)(t.$filters.currency(a.price)),1),(0,s.Lk)("span",null,[b.status.loadingItem===a.id?((0,s.uX)(),(0,s.CE)("button",{key:0,class:"btn btn-shopping btn-sm",type:"button",disabled:b.status.loadingItem===a.id,onClick:t=>g.addToCart(a.id)},[A,(0,s.eW)(" 加到購物車 ")],8,E)):((0,s.uX)(),(0,s.CE)("button",{key:1,class:"btn btn-shopping btn-sm",type:"button",onClick:t=>g.addToCart(a.id)}," 加到購物車 ",8,X))])]),(0,s.Lk)("div",$,[(0,s.Lk)("div",H,[0!==a.origin_price?((0,s.uX)(),(0,s.CE)("span",j,(0,i.v_)(t.$filters.currency(a.origin_price)),1)):(0,s.Q3)("",!0),(0,s.Lk)("span",T,(0,i.v_)(t.$filters.currency(a.price)),1)]),b.status.loadingItem===a.id?((0,s.uX)(),(0,s.CE)("button",{key:0,class:"btn btn-shopping btn-sm",type:"button",disabled:b.status.loadingItem===a.id,onClick:t=>g.addToCart(a.id)},[M,(0,s.eW)(" 加到購物車 ")],8,F)):((0,s.uX)(),(0,s.CE)("button",{key:1,class:"btn btn-shopping btn-sm",type:"button",onClick:t=>g.addToCart(a.id)}," 加到購物車 ",8,W))]),(0,s.Lk)("button",{href:"#",class:"follow-close",onClick:(0,o.D$)((t=>g.delFollow(a.id)),["prevent"])},G,8,U)])])))),128))])):((0,s.uX)(),(0,s.CE)("div",Q,[V,(0,s.bF)(B,{to:"/products",class:"text-cyanine"},{default:(0,s.k6)((()=>[S,(0,s.eW)(" 逛逛商品 ")])),_:1})]))])])]),b.isLoading?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("section",q,J))])}var Y=e(2541),Z=e(8285),N=e(8965),O=e(1601),R=e(1884),tt={data(){return{isLoading:!1,status:{loadingItem:""},products:{},followProduct:{},sortData:"",followData:[],pagination:{},carts:{},uid:null}},components:{Pagination:Z.A},created(){this.getAuthState(),this.getProducts()},watch:{uid(t,a){t?this.getProducts():this.$router.replace("/userlogin")}},methods:{getAuthState(){(0,O.hg)(N.j2,(t=>{t?t.emailVerified?(this.uid=t.uid,this.updateUserCartItem()):this.uid=null:(this.uid=null,Y.A.fire({icon:"warning",title:"請先登入會員"}),this.$router.replace("/userlogin"))}))},async updateUserCartItem(t){const a=(0,R.rJ)(N.db,"userInfo"),e=(0,R.H9)(a,this.uid),s=await(0,R.x7)(e);if(s.exists()){if(this.userCartItems=s.data().cartItem,void 0!==t){const a=this.userCartItems.findIndex((a=>a.product.id===t.product.id));-1!==a&&this.userCartItems.splice(a,1),this.userCartItems.push(t),await(0,R.mZ)(e,{cartItem:this.userCartItems})}}else console.log("No such document!")},getProducts(){const t="https://fullstack-ecommerce-pojui-backend-vercel.vercel.app/products/all";this.isLoading=!0,this.$http.get(t).then((t=>{this.products=t.data.products,null!==this.uid&&this.getFollow(),setTimeout((()=>{this.isLoading=!1}),1e3)})).catch((()=>{Y.A.fire({title:"資料讀取失敗，請稍後再試",icon:"error"}),this.isLoading=!1}))},async getFollow(){const t=(0,R.rJ)(N.db,"userInfo"),a=(0,R.H9)(t,this.uid),e=await(0,R.x7)(a);e.exists()&&(this.followData=e.data().favorite),this.followProduct=this.products.filter((t=>this.followData.indexOf(t.id)>-1))},addToCart(t){this.status.loadingItem=t;const a=`https://fullstack-ecommerce-pojui-backend-vercel.vercel.app/cart/${this.uid}/add`,e={product_id:t,qty:1};this.$http.post(a,{data:e}).then((t=>{this.updateUserCartItem(t.data.data),setTimeout((()=>{this.status.loadingItem="",this.$emitter.emit("update-total",this.uid),Y.A.fire({title:"已加入購物車",icon:"success"})}),500)})).catch((t=>{this.status.loadingItem="",Y.A.fire({title:`${t.response.data.errors}`,icon:"warning"})}))},async delFollow(t){const a=this.followData.indexOf(t);if(-1!==a){this.followData.splice(a,1),Y.A.fire({title:"已取消收藏",icon:"success"});const t=(0,R.rJ)(N.db,"userInfo"),e=(0,R.H9)(t,this.uid),s=await(0,R.x7)(e);s.exists()&&await(0,R.mZ)(e,{favorite:this.followData})}this.getProducts()},sortProduct(){this.followProduct.sort(((t,a)=>"lowToHigh"===this.sortData?t.price-a.price:"highToLow"===this.sortData?a.price-t.price:this.followProduct))}}},at=e(6262);const et=(0,at.A)(tt,[["render",K],["__scopeId","data-v-5b6c9ba4"]]);var st=et}}]);
//# sourceMappingURL=132.01a1c35d.js.map